<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EcoMission â€” ê¸°í›„Â·í™˜ê²½Â·ìƒíƒœ í†µí•© ì›¹ì•±</title>
<style>
  /* ---------- ê¸°ë³¸ ìŠ¤íƒ€ì¼ ---------- */
  :root{
    --bg:#f3faf6;
    --card:#ffffff;
    --accent:#2aa86b; /* ì´ˆë¡ */
    --accent-2:#2bb7e6; /* ì²­ë¡ */
    --muted:#6b7280;
    --glass: rgba(255,255,255,0.65);
    --shadow: 0 6px 18px rgba(15,23,42,0.08);
    font-family: "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg, #e9fbf5 0%, var(--bg) 100%);color:#0f172a;}
  a{color:inherit}
  .app{display:flex;min-height:100vh;gap:24px;padding:28px;box-sizing:border-box;}
  /* ---------- ì‚¬ì´ë“œë°” ---------- */
  .sidebar{
    width:300px;background:linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.82));
    border-radius:16px;padding:20px;box-shadow:var(--shadow);backdrop-filter: blur(6px);
    display:flex;flex-direction:column;gap:16px;
  }
  .brand{
    display:flex;align-items:center;gap:12px;
  }
  .logo{
    width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));
    display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px;
    box-shadow: 0 6px 18px rgba(43,166,107,0.22);
  }
  .brand h1{font-size:18px;margin:0;}
  .user-card{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px;background:rgba(43,166,107,0.06);border-radius:10px}
  .user-info{display:flex;gap:10px;align-items:center}
  .avatar{width:42px;height:42px;border-radius:10px;background:linear-gradient(180deg,#fff,#f1fff6);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent)}
  .nav{display:flex;flex-direction:column;gap:8px}
  .nav button{background:none;border:none;text-align:left;padding:10px;border-radius:10px;cursor:pointer;font-weight:600;color:#074b32}
  .nav button.active{background:linear-gradient(90deg, rgba(43,166,107,0.12), rgba(43,166,107,0.06));box-shadow:inset 0 0 0 1px rgba(43,166,107,0.04)}
  .small{font-size:12px;color:var(--muted)}
  .leaderboard{background:linear-gradient(180deg, rgba(43,166,107,0.03), rgba(43,166,107,0.01));padding:12px;border-radius:10px;}
  .leaderboard h4{margin:0 0 8px 0;font-size:13px}
  .leader-row{display:flex;justify-content:space-between;font-weight:600;padding:6px 0}
  .footer{margin-top:auto;font-size:12px;color:var(--muted)}
  /* ---------- ë©”ì¸ ---------- */
  .main{flex:1;display:flex;flex-direction:column;gap:20px}
  .topbar{display:flex;justify-content:space-between;align-items:center;gap:12px}
  .searchbox{flex:1;display:flex;gap:10px;align-items:center;background:var(--card);padding:10px;border-radius:12px;box-shadow:var(--shadow)}
  .searchbox input{border:none;outline:none;font-size:14px;background:transparent;flex:1}
  .stats{display:flex;gap:14px}
  .stat-card{background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow);min-width:160px;display:flex;flex-direction:column;gap:8px}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
  .col-8{grid-column:span 8}
  .col-4{grid-column:span 4}
  .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:var(--shadow)}
  h2{margin:0;font-size:18px}
  p.lead{color:var(--muted);margin:6px 0 0 0}
  /* ---------- Missions ---------- */
  .missions-list{display:flex;flex-direction:column;gap:10px;margin-top:12px}
  .mission{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;border:1px solid rgba(11,85,46,0.04)}
  .mission .left{display:flex;gap:12px;align-items:center}
  .badge{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;padding:6px 10px;border-radius:999px;font-weight:700}
  .mission button{background:var(--accent);color:white;border:none;padding:8px 12px;border-radius:8px;font-weight:700;cursor:pointer}
  .mission button.secondary{background:#eaf8f0;color:var(--accent);font-weight:700}
  /* ---------- Marketplace ---------- */
  .market-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px}
  .item-card{padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfffb);box-shadow: 0 8px 20px rgba(13,48,34,0.04);display:flex;flex-direction:column;gap:8px}
  .item-card img{width:100%;height:140px;object-fit:cover;border-radius:8px}
  .item-actions{display:flex;justify-content:space-between;align-items:center}
  .btn{padding:8px 10px;border-radius:8px;border:none;cursor:pointer}
  .btn.green{background:var(--accent);color:#fff}
  .btn.ghost{background:transparent;border:1px solid rgba(11,85,46,0.08)}
  /* ---------- Recommendations ---------- */
  .rec-list{display:flex;flex-direction:column;gap:10px}
  .rec{display:flex;gap:12px;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(90deg, rgba(43,166,107,0.03), rgba(43,166,107,0.01))}
  .rec img{width:64px;height:64px;object-fit:cover;border-radius:8px}
  /* ---------- Carbon Lab ---------- */
  .carbon-form{display:flex;flex-direction:column;gap:10px}
  .row{display:flex;gap:10px}
  .input,select{padding:8px;border-radius:8px;border:1px solid #e6eef0;outline:none}
  .result{background:linear-gradient(180deg,#f8fffb,#ecfff6);padding:12px;border-radius:10px}
  /* ---------- ë°˜ì‘í˜• ---------- */
  @media (max-width:1000px){
    .app{flex-direction:column;padding:16px}
    .sidebar{width:100%;flex-direction:row;overflow:auto;padding:12px}
    .main{width:100%}
    .grid{grid-template-columns:repeat(6,1fr)}
    .col-8{grid-column:span 6}
    .col-4{grid-column:span 6}
    .market-grid{grid-template-columns:repeat(2,1fr)}
  }
  @media (max-width:640px){
    .brand h1{display:none}
    .sidebar{gap:8px}
    .leaderboard{display:none}
    .market-grid{grid-template-columns:1fr}
  }

  /* ---------- ì‘ê³  ì¾Œì í•œ ì• ë‹ˆë©”ì´ì…˜ ---------- */
  .grow{transition:transform .18s ease}
  .grow:active{transform:scale(.98)}
  .leaf-anim{animation:leaf 2.5s ease-in-out infinite}
  @keyframes leaf{
    0%{transform:translateY(0) rotate(0deg)}
    50%{transform:translateY(-6px) rotate(2deg)}
    100%{transform:translateY(0) rotate(0deg)}
  }
</style>
</head>
<body>
<div class="app">
  <!-- SIDEBAR -->
  <aside class="sidebar" aria-label="Navigation">
    <div class="brand">
      <div class="logo">EM</div>
      <div>
        <h1>EcoMission</h1>
        <div class="small">ì‘ì€ í–‰ë™, í° ë³€í™”</div>
      </div>
    </div>

    <div class="user-card" id="userCard">
      <div class="user-info">
        <div class="avatar" id="avatarText">ì±„</div>
        <div>
          <div id="username">ì±„ì€</div>
          <div class="small" id="userPointsSmall">í¬ì¸íŠ¸: 0</div>
        </div>
      </div>
      <div style="text-align:right">
        <div class="small">ë ˆë²¨</div>
        <div id="userLevel" style="font-weight:800;color:var(--accent)">Lv.1</div>
      </div>
    </div>

    <nav class="nav" role="navigation">
      <button class="active" data-view="dashboard">ëŒ€ì‹œë³´ë“œ</button>
      <button data-view="missions">ë¯¸ì…˜(ì±Œë¦°ì§€)</button>
      <button data-view="market">ë§ˆì¼“(ì¬í™œìš© ê±°ë˜)</button>
      <button data-view="recs">ì¶”ì²œ(ë¸Œëœë“œ)</button>
      <button data-view="carbon">Carbon Lab</button>
    </nav>

    <div class="leaderboard">
      <h4>ì£¼ê°„ ë­í‚¹</h4>
      <div id="leaderboardRows">
        <!-- JSê°€ ì±„ì›€ -->
      </div>
    </div>

    <div class="footer small">
      ì œì‘ì: EcoMission íŒ€ Â· êµìœ¡Â·í™œë™ìš© ë°ëª¨<br>
      ì €ì¥: ë¡œì»¬ (localStorage)
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <div class="topbar">
      <div class="searchbox">
        <svg width="20" height="20" viewBox="0 0 24 24" style="opacity:.7"><path fill="#074b32" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20l-6-6zM10 15a5 5 0 110-10 5 5 0 010 10z"/></svg>
        <input id="search" placeholder="ë¯¸ì…˜Â·ìƒí’ˆÂ·ë¸Œëœë“œ ê²€ìƒ‰" />
        <button class="btn ghost" id="btnShare">ê³µìœ í•˜ê¸°</button>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <div class="small">í¬ì¸íŠ¸</div>
        <div class="badge" id="topPoints">0</div>
      </div>
    </div>

    <!-- STATS -->
    <div class="stats">
      <div class="stat-card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="small">ì „ì²´ í¬ì¸íŠ¸</div>
            <div style="font-size:20px;font-weight:800" id="statPoints">0</div>
          </div>
          <div style="text-align:right">
            <div class="small">íƒ„ì†Œ ì ˆê°ëŸ‰(ì˜ˆì¸¡)</div>
            <div style="font-weight:800;color:var(--accent)" id="statCO2">0 kg</div>
          </div>
        </div>
      </div>

      <div class="stat-card">
        <div class="small">ë¯¸ì…˜ ì§„í–‰</div>
        <div style="display:flex;align-items:center;gap:8px">
          <div style="font-weight:800" id="statMissions">0</div>
          <div class="small">ì™„ë£Œ</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="small">ë§ˆì¼“ ê±°ë˜</div>
        <div style="font-weight:800" id="statTrades">0</div>
      </div>
    </div>

    <!-- GRID -->
    <div class="grid">
      <section class="col-8 card" id="viewDashboard">
        <h2>ëŒ€ì‹œë³´ë“œ</h2>
        <p class="lead">ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ê³¼ ìµœê·¼ í™œë™ì„ í•œëˆˆì— í™•ì¸í•´ë³´ì„¸ìš”.</p>

        <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
          <div style="flex:1;min-width:220px" class="card">
            <h3 style="margin:0">ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë¯¸ì…˜</h3>
            <div id="todayMission" style="margin-top:10px"></div>
          </div>

          <div style="flex:1;min-width:220px" class="card">
            <h3 style="margin:0">ë‚´ í™œë™ íˆìŠ¤í† ë¦¬</h3>
            <div id="activityLog" style="margin-top:10px;max-height:160px;overflow:auto"></div>
          </div>
        </div>

        <div class="card" style="margin-top:12px">
          <h3 style="display:flex;align-items:center;gap:10px;margin:0">
            <span>ë¦¬ë”ë³´ë“œ</span>
            <svg class="leaf-anim" width="26" height="26" viewBox="0 0 24 24"><path fill="#2aa86b" d="M12 2C8 6 4 15 12 22c8-7 4-16 0-20z"/></svg>
          </h3>
          <div id="leaderboardMain" style="margin-top:10px"></div>
        </div>
      </section>

      <section class="col-4 card" id="sideQuick">
        <h2>ë¹ ë¥¸ í–‰ë™</h2>
        <p class="lead">ë°”ë¡œ í•  ìˆ˜ ìˆëŠ” ì‘ì€ í–‰ë™ë“¤</p>

        <div style="display:flex;flex-direction:column;gap:8px;margin-top:10px">
          <button class="btn green grow" id="btnQuickTransit">ëŒ€ì¤‘êµí†µìœ¼ë¡œ ì¶œê·¼í•˜ê¸° (+10P)</button>
          <button class="btn green grow" id="btnQuickCup">í…€ë¸”ëŸ¬ ì‚¬ìš©í•˜ê¸° (+5P)</button>
          <button class="btn green grow" id="btnQuickVeg">ì˜¤ëŠ˜ ì±„ì‹í•˜ê¸° (+8P)</button>
        </div>

        <div style="margin-top:14px">
          <h4 style="margin:0">ì¹œí™˜ê²½ íŒ</h4>
          <p class="small" style="margin-top:8px">ì „ë“± 1ì‹œê°„ ì¤„ì´ë©´ ì•½ 0.04kg COâ‚‚ ì ˆê°. ì‘ì€ ë³€í™”ê°€ ëª¨ì´ë©´ ì»¤ìš”.</p>
        </div>
      </section>

      <!-- Missions view -->
      <section class="col-8 card" id="viewMissions" style="display:none">
        <h2>ë¯¸ì…˜(ì±Œë¦°ì§€)</h2>
        <p class="lead">ë¯¸ì…˜ì„ ìˆ˜í–‰í•˜ê³  í¬ì¸íŠ¸ë¥¼ ëª¨ì•„ë³´ì„¸ìš”.</p>

        <div style="display:flex;gap:12px;margin-top:12px">
          <div style="flex:1">
            <div class="card">
              <h3 style="margin:0">ë¯¸ì…˜ ëª©ë¡</h3>
              <div class="missions-list" id="missionsList"></div>
              <div style="margin-top:8px;display:flex;gap:8px">
                <input id="newMissionText" class="input" placeholder="ìƒˆ ë¯¸ì…˜ ì¶”ê°€ (ex: 30ë¶„ ê±·ê¸°)" />
                <input id="newMissionPoints" class="input" placeholder="í¬ì¸íŠ¸" style="width:80px" />
                <button class="btn green" id="addMissionBtn">ì¶”ê°€</button>
              </div>
            </div>
          </div>

          <div style="width:280px">
            <div class="card">
              <h3 style="margin:0">ë‚´ ë±ƒì§€</h3>
              <div id="badges" style="display:flex;flex-wrap:wrap;gap:8px;margin-top:8px"></div>
            </div>

            <div class="card" style="margin-top:12px">
              <h3 style="margin:0">ì£¼ê°„ ëª©í‘œ</h3>
              <div style="margin-top:8px">
                <label class="small">ì´ë²ˆì£¼ ëª©í‘œ í¬ì¸íŠ¸</label>
                <input id="weeklyGoal" class="input" type="number" min="0" />
                <div style="margin-top:8px">
                  <div class="small">ì§„í–‰</div>
                  <div id="goalProgress" style="font-weight:800;color:var(--accent)">0 / 0</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Marketplace view -->
      <section class="col-8 card" id="viewMarket" style="display:none">
        <h2>ë§ˆì¼“(ì¬í™œìš© ê±°ë˜)</h2>
        <p class="lead">ì•ˆ ì“°ëŠ” ë¬¼ê±´ì„ ì˜¬ë¦¬ê³  í¬ì¸íŠ¸ë¡œ ê±°ë˜í•˜ì„¸ìš”.</p>

        <div style="display:flex;gap:12px;margin-top:12px">
          <div style="flex:1">
            <div style="display:flex;gap:8px">
              <input id="sellTitle" class="input" placeholder="ë¬¼ê±´ ì´ë¦„" />
              <input id="sellPrice" class="input" placeholder="ê°€ê²©(P)" style="width:100px" />
            </div>
            <textarea id="sellDesc" class="input" placeholder="ì„¤ëª… (ìƒíƒœ, ìˆ˜ê±°ë°©ë²• ë“±)" style="margin-top:8px"></textarea>
            <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
              <input id="sellImg" class="input" placeholder="ì´ë¯¸ì§€ URL (ì„ íƒ)" />
              <button class="btn green" id="postItem">ë“±ë¡</button>
            </div>

            <div style="margin-top:12px">
              <h3 style="margin:0">ê±°ë˜ ëª©ë¡</h3>
              <div class="market-grid" id="marketGrid"></div>
            </div>
          </div>

          <div style="width:280px">
            <div class="card">
              <h3 style="margin:0">ë‚´ íŒë§¤ë‚´ì—­</h3>
              <div id="mySales" style="margin-top:8px"></div>
            </div>

            <div class="card" style="margin-top:12px">
              <h3 style="margin:0">í†µê³„</h3>
              <div style="margin-top:8px">
                <div class="small">ì´ ê±°ë˜</div>
                <div id="statTrades2" style="font-weight:800">0</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Recommendations view -->
      <section class="col-4 card" id="viewRecs" style="display:none">
        <h2>ì¶”ì²œ ë¸Œëœë“œ & ì œíœ´</h2>
        <p class="lead">í™˜ê²½ì„ ìƒê°í•œ ì œí’ˆë“¤ì„ íë ˆì´ì…˜í–ˆìŠµë‹ˆë‹¤.</p>

        <div style="margin-top:12px">
          <h4>ìŠ¤í°ì„œ ì œíœ´</h4>
          <div class="rec-list" id="recList"></div>
        </div>

        <div class="card" style="margin-top:12px">
          <h4 style="margin:0">í¬ì¸íŠ¸ êµí™˜</h4>
          <p class="small">í¬ì¸íŠ¸ë¡œ ì œíœ´ ìƒí’ˆ ì¿ í°ì„ êµí™˜í•  ìˆ˜ ìˆì–´ìš”.</p>
          <div style="margin-top:8px;display:flex;gap:8px">
            <select id="couponSelect" class="input">
              <option value="0">ì¿ í° ì„ íƒ</option>
              <option value="100">ì¹œí™˜ê²½ í…€ë¸”ëŸ¬ êµí™˜ê¶Œ (100P)</option>
              <option value="50">ë¦¬í•„ìŠ¤í…Œì´ì…˜ 10% í• ì¸ (50P)</option>
            </select>
            <button class="btn green" id="redeemBtn">êµí™˜</button>
          </div>
        </div>
      </section>

      <!-- Carbon Lab view -->
      <section class="col-8 card" id="viewCarbon" style="display:none">
        <h2>Carbon Lab</h2>
        <p class="lead">ê°„ë‹¨í•œ í™œë™ ì…ë ¥ìœ¼ë¡œ íƒ„ì†Œ ë°°ì¶œì„ ê³„ì‚°í•˜ê³  ì˜¤í”„ì…‹í•˜ì„¸ìš”.</p>

        <div class="carbon-form" style="margin-top:12px">
          <div class="row">
            <div style="flex:1">
              <label class="small">êµí†µ (í•˜ë£¨ ì™•ë³µ ê±°ë¦¬, km)</label>
              <input id="inputKm" class="input" type="number" value="10" />
            </div>
            <div style="flex:1">
              <label class="small">ì „ê¸° ì‚¬ìš© (kWh / ì›”)</label>
              <input id="inputKwh" class="input" type="number" value="150" />
            </div>
          </div>
          <div class="row">
            <div style="flex:1">
              <label class="small">ì‹ë‹¨ (ì£¼ í‰ê·  ì±„ì‹ì¼ ìˆ˜)</label>
              <input id="inputVegDays" class="input" type="number" value="2" min="0" max="7" />
            </div>
            <div style="flex:1">
              <label class="small">ê°€êµ¬ì› ìˆ˜</label>
              <input id="inputHouse" class="input" type="number" value="1" min="1" />
            </div>
          </div>

          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn green" id="calcCarbon">ê³„ì‚°</button>
            <div id="carbonResult" class="result" style="flex:1">ê²°ê³¼: â€” kgCOâ‚‚e</div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
            <label class="small">ì˜¤í”„ì…‹ ì˜µì…˜</label>
            <select id="offsetOption" class="input">
              <option value="tree" data-cost="5">ë‚˜ë¬´ 1ê·¸ë£¨ ì‹¬ê¸° (5P, ì•½ 20kg COâ‚‚ ìƒì‡„)</option>
              <option value="fund" data-cost="50">ì§€ì—­ ë³µì› í€ë“œ (50P)</option>
            </select>
            <button class="btn green" id="offsetBtn">ì˜¤í”„ì…‹(í¬ì¸íŠ¸)</button>
          </div>

          <div style="margin-top:8px">
            <h4 style="margin:0">ì˜¤í”„ì…‹ íˆìŠ¤í† ë¦¬</h4>
            <div id="offsetHistory" style="margin-top:8px"></div>
          </div>
        </div>
      </section>
    </div>

  </main>
</div>

<script>
/* =========================
   EcoMission â€” Frontend JS
   =========================
   ë¡œì»¬ ì €ì¥ì†Œ í‚¤ì™€ ê¸°ë³¸ ë°ì´í„° ì„¤ì •.
*/

const STORAGE_KEY = 'eco_app_v1';
const sampleUsers = [
  {name:'ì±„ì€', points:0},
  {name:'ë‚˜í˜„', points:0},
  {name:'ì˜ˆë¦¼', points:0},
  {name:'ë‹¤í˜„', points:0},
  {name:'ì•„ì—°', points:0},
];

const defaults = {
  username: 'ì±„ì€',
  points: 0,
  level: 1,
  missions: [
    {id:1, text:'í…€ë¸”ëŸ¬ë¡œ ìŒë£Œ ë§ˆì‹œê¸°', points:5, done:false},
    {id:2, text:'ëŒ€ì¤‘êµí†µ ì´ìš©í•˜ê¸°', points:10, done:false},
    {id:3, text:'ì±„ì‹ í•œ ë¼', points:8, done:false},
  ],
  activities: [],
  market: [
    {id:1,title:'ì»¤ìŠ¤í…€ í…€ë¸”ëŸ¬(ë³´ê´€ìƒíƒœ ì¢‹ìŒ)', price:120, desc:'ê¹¨ë—í•˜ê²Œ ì‚¬ìš©í•œ í…€ë¸”ëŸ¬ì…ë‹ˆë‹¤.', img:'' ,seller:'ì±„ì€'},
    {id:2,title:'ì¤‘ê³  ì „ê¸°ìì „ê±° í—¬ë©§', price:80, desc:'ì‚´ì§ ì‚¬ìš©ê° ìˆìœ¼ë‚˜ ì•ˆì „í•œ ìƒíƒœ', img:'', seller:'ê°€ê²½'},
  ],
  sales: [],
  recs: [
    {id:1,title:'ë¦¬í•„ìŠ¤í…Œì´ì…˜', desc:'ìš©ê¸° ì¬ì‚¬ìš©ìœ¼ë¡œ í”Œë¼ìŠ¤í‹± ê°ì†Œ', img:'', link:'#'},
    {id:2,title:'ì œë¡œì›¨ì´ìŠ¤íŠ¸ ìƒµ', desc:'í¬ì¥ ìµœì†Œí™” ìƒí’ˆ', img:'', link:'#'},
    {id:3,title:'ì¹œí™˜ê²½ ì„¸ì œ', desc:'ìƒë¶„í•´ì„± ì„±ë¶„', img:'', link:'#'}
  ],
  trades: 0,
  carbon: {
    offsets: [],
    lastEstimateKg:0
  },
  weeklyGoal: 200
};

// ì €ì¥ì†Œ ë¶ˆëŸ¬ì˜¤ê¸°
function loadStore(){
  const raw = localStorage.getItem(STORAGE_KEY);
  if(!raw) { localStorage.setItem(STORAGE_KEY, JSON.stringify(defaults)); return JSON.parse(JSON.stringify(defaults)); }
  try { return JSON.parse(raw); } catch(e){ localStorage.setItem(STORAGE_KEY, JSON.stringify(defaults)); return JSON.parse(JSON.stringify(defaults)); }
}
function saveStore(state){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

// ì „ì—­ state
let state = loadStore();

/* ---------- ìœ í‹¸ ---------- */
const $ = (sel, base=document) => base.querySelector(sel);
const $$ = (sel, base=document) => Array.from(base.querySelectorAll(sel));
function formatPoints(n){ return Math.round(n) + ' P'; }
function uid(prefix='i'){ return prefix + Math.random().toString(36).slice(2,9); }
function notify(msg){ console.log('[Notify]',msg); /* ê°„ë‹¨ ì•Œë¦¼ â€” í•„ìš” ì‹œ ì»¤ìŠ¤í…€ */ }

/* ---------- UI ì´ˆê¸°í™” ---------- */
function renderUser(){
  $('#username').textContent = state.username;
  $('#avatarText').textContent = state.username[0] || 'ì´';
  $('#userPointsSmall').textContent = 'í¬ì¸íŠ¸: ' + state.points;
  $('#topPoints').textContent = state.points;
  $('#statPoints').textContent = state.points;
  $('#userLevel').textContent = 'Lv.' + state.level;
}
function renderMissions(){
  const wrap = $('#missionsList'); wrap.innerHTML = '';
  state.missions.forEach(m=>{
    const el = document.createElement('div'); el.className='mission';
    el.innerHTML = `
      <div class="left">
        <div class="badge">${m.points}P</div>
        <div>
          <div style="font-weight:800">${m.text}</div>
          <div class="small">${m.done? 'ì™„ë£Œë¨' : 'ë¯¸ì™„ë£Œ'}</div>
        </div>
      </div>
      <div>
        ${m.done ? `<button class="btn secondary" data-id="${m.id}">ë³´ìƒ ìˆ˜ë ¹</button>` : `<button class="btn green" data-id="${m.id}">ì™„ë£Œ</button>`}
      </div>
    `;
    wrap.appendChild(el);
  });
}
function renderBadges(){
  const wrap = $('#badges'); wrap.innerHTML = '';
  // ê°„ë‹¨ ê·œì¹™: í¬ì¸íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ë±ƒì§€
  const badges = [];
  if(state.points >= 100) badges.push('ë…¹ìƒ‰ íŒŒìˆ˜ê¾¼');
  if(state.missions.filter(m=>m.done).length >= 3) badges.push('ë¯¸ì…˜ ë§ˆìŠ¤í„°');
  if(state.trades >= 1) badges.push('ìˆœí™˜ ìƒì¸');
  if(state.carbon.offsets.length > 0) badges.push('ì§€êµ¬ë¥¼ ì‹¬ì€ ì‚¬ëŒ');
  if(badges.length===0) badges.push('ìƒˆì‹¹ ì‹œì‘ì');

  badges.forEach(b=>{
    const d = document.createElement('div');
    d.className='badge';
    d.style.background='linear-gradient(90deg, var(--accent), var(--accent-2))';
    d.style.padding='6px 10px';
    d.textContent = b;
    wrap.appendChild(d);
  });
}

function renderTodayMission(){
  const idx = Math.floor(Math.random()*state.missions.length);
  const m = state.missions[idx] || {text:'í…€ë¸”ëŸ¬ ì‚¬ìš©í•˜ê¸°', points:5};
  $('#todayMission').innerHTML = `
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div style="font-weight:800">${m.text}</div>
        <div class="small">ë³´ìƒ ${m.points}P Â· ì¶”ì²œ</div>
      </div>
      <button class="btn green" data-id="${m.id}" id="todayDoBtn">ì™„ë£Œ</button>
    </div>
  `;
  $('#todayDoBtn').onclick = ()=> completeMission(m.id);
}

function renderActivityLog(){
  const el = $('#activityLog'); el.innerHTML = '';
  state.activities.slice().reverse().slice(0,40).forEach(a=>{
    const d = document.createElement('div');
    d.style.padding='6px 0'; d.style.borderBottom='1px dashed #eef7f0';
    d.innerHTML = `<div style="font-weight:700">${a.title}</div><div class="small">${a.time}</div>`;
    el.appendChild(d);
  });
}

function renderLeaderboard(){
  const rows = $('#leaderboardRows'); rows.innerHTML='';
  // ìƒ˜í”Œ ì‚¬ìš©ìì™€ ë‚˜ í•©ì¹˜ê¸°
  const all = sampleUsers.map(u=>({name:u.name, points:u.points})).concat([{name:state.username,points:state.points}]);
  const sorted = all.sort((a,b)=>b.points-a.points).slice(0,5);
  sorted.forEach((u,i)=>{
    const r = document.createElement('div'); r.className='leader-row';
    r.innerHTML = `<div>${i+1}. ${u.name}</div><div style="color:var(--accent);font-weight:800">${u.points}P</div>`;
    rows.appendChild(r);
  });

  // ë©”ì¸ ë¦¬ë”ë³´ë“œ
  const main = $('#leaderboardMain'); main.innerHTML='';
  sorted.forEach(u=>{
    const row = document.createElement('div'); row.style.display='flex';row.style.justifyContent='space-between';row.style.padding='6px 0';
    row.innerHTML = `<div style="font-weight:700">${u.name}</div><div style="color:var(--accent)">${u.points} P</div>`;
    main.appendChild(row);
  });
}

function renderMarket(){
  const grid = $('#marketGrid'); grid.innerHTML='';
  state.market.forEach(item=>{
    const card = document.createElement('div'); card.className='item-card';
    card.innerHTML = `
      <img src="${item.img || 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22300%22 height=%22180%22><rect width=%22300%22 height=%22180%22 fill=%22%23f4fff8%22/><text x=%2210%22 y=%2290%22 fill=%22%230a3b2b%22 font-size=%2214%22>ì´ë¯¸ì§€ ì—†ìŒ</text></svg>'}" alt="">
      <div style="display:flex;flex-direction:column;gap:4px">
        <div style="font-weight:800">${item.title}</div>
        <div class="small">${item.desc}</div>
      </div>
      <div class="item-actions">
        <div style="font-weight:800">${item.price} P</div>
        <div>
          ${item.seller === state.username ? '<button class="btn ghost" data-id="'+item.id+'">ë‚´ ë¬¼ê±´</button>' : '<button class="btn green" data-buy="'+item.id+'">êµ¬ë§¤</button>'}
        </div>
      </div>
    `;
    grid.appendChild(card);
  });
  // êµ¬ë§¤ ë²„íŠ¼ ë°”ì¸ë”©
  $$('.item-card .btn.green', grid).forEach(b=>{
    b.onclick = (ev)=>{
      const id = +b.getAttribute('data-buy');
      buyItem(id);
    };
  });

  // my sales
  const ms = $('#mySales'); ms.innerHTML='';
  state.market.filter(i=>i.seller===state.username).forEach(i=>{
    const d = document.createElement('div'); d.style.padding='6px 0'; d.innerHTML = `<div style="font-weight:800">${i.title}</div><div class="small">${i.price} P</div>`;
    ms.appendChild(d);
  });

  $('#statTrades2').textContent = state.trades;
}

function renderRecs(){
  const list = $('#recList'); list.innerHTML='';
  state.recs.forEach(r=>{
    const div = document.createElement('div'); div.className='rec';
    div.innerHTML = `
      <img src="${r.img || 'data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2264%22 height=%2264%22><rect width=%2264%22 height=%2264%22 fill=%22%23e6fbf0%22/><text x=%226%22 y=%2240%22 fill=%22%23094835%22 font-size=%2210%22>ë¸Œëœë“œ</text></svg>'}" />
      <div style="flex:1">
        <div style="font-weight:800">${r.title}</div>
        <div class="small">${r.desc}</div>
      </div>
      <div><a href="${r.link}" class="btn green" target="_blank">ìì„¸íˆ</a></div>
    `;
    list.appendChild(div);
  });
}

function renderCarbon(){
  $('#carbonResult').textContent = `ê²°ê³¼: ${Math.round(state.carbon.lastEstimateKg)} kgCOâ‚‚e`;
  $('#offsetHistory').innerHTML = '';
  state.carbon.offsets.slice().reverse().forEach(o=>{
    const d = document.createElement('div');
    d.style.padding='6px 0'; d.style.borderBottom='1px dashed #eef7f0';
    d.innerHTML = `<div style="font-weight:800">${o.type}</div><div class="small">${o.time} Â· ${o.cost}P ì‚¬ìš©</div>`;
    $('#offsetHistory').appendChild(d);
  });
}

/* ---------- Actions ---------- */

function saveAndRerender(){
  saveStore(state);
  renderAll();
}

function renderAll(){
  renderUser();
  renderMissions();
  renderBadges();
  renderTodayMission();
  renderActivityLog();
  renderLeaderboard();
  renderMarket();
  renderRecs();
  renderCarbon();
  $('#statMissions').textContent = state.missions.filter(m=>m.done).length;
  $('#statTrades').textContent = state.trades;
  $('#goalProgress').textContent = `${state.points} / ${state.weeklyGoal}`;
}

/* ë¯¸ì…˜ ì™„ë£Œ */
function completeMission(id){
  const m = state.missions.find(x=>x.id==id);
  if(!m) return;
  if(m.done){
    // ë³´ìƒ ìˆ˜ë ¹ ë˜ëŠ” ì´ë¯¸ ìˆ˜ë ¹ ìƒíƒœ(ë‹¨ìˆœí™”)
    notify('ì´ë¯¸ ì™„ë£Œëœ ë¯¸ì…˜ì…ë‹ˆë‹¤.');
    return;
  }
  m.done = true;
  state.points += m.points;
  state.activities.push({title:`ë¯¸ì…˜ ì™„ë£Œ: ${m.text} (+${m.points}P)`, time: new Date().toLocaleString()});
  state.trades = state.trades; // no change
  saveAndRerender();
}

/* ë¯¸ì…˜ ìˆ˜ë ¹ (ë³´ìƒ) - in this design, ì™„ë£Œì™€ ìˆ˜ë ¹ì€ ë™ì¼ */
function claimReward(id){
  // ê°„ë‹¨íˆ completeMissionê³¼ ë™ì¼ ì²˜ë¦¬
  completeMission(id);
}

/* ìƒˆ ë¯¸ì…˜ ì¶”ê°€ */
$('#addMissionBtn').onclick = ()=>{
  const text = $('#newMissionText').value.trim();
  const pts = parseInt($('#newMissionPoints').value) || 5;
  if(!text) return alert('ë¯¸ì…˜ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');
  const newM = {id:Date.now(), text, points:pts, done:false};
  state.missions.push(newM);
  state.activities.push({title:`ë¯¸ì…˜ ì¶”ê°€: ${text}`, time:new Date().toLocaleString()});
  $('#newMissionText').value=''; $('#newMissionPoints').value='';
  saveAndRerender();
};

/* í€µ ë²„íŠ¼ */
$('#btnQuickTransit').onclick = ()=> { state.points+=10; state.activities.push({title:'ëŒ€ì¤‘êµí†µ ì´ìš©(+10P)', time:new Date().toLocaleString()}); saveAndRerender(); };
$('#btnQuickCup').onclick = ()=> { state.points+=5; state.activities.push({title:'í…€ë¸”ëŸ¬ ì‚¬ìš©(+5P)', time:new Date().toLocaleString()}); saveAndRerender(); };
$('#btnQuickVeg').onclick = ()=> { state.points+=8; state.activities.push({title:'ì±„ì‹ í•œë¼(+8P)', time:new Date().toLocaleString()}); saveAndRerender(); };

/* ë§ˆì¼“: ë“±ë¡ */
$('#postItem').onclick = ()=>{
  const title = $('#sellTitle').value.trim();
  const price = parseInt($('#sellPrice').value) || 10;
  const desc = $('#sellDesc').value.trim();
  const img = $('#sellImg').value.trim();
  if(!title) return alert('ìƒí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”.');
  const it = {id:Date.now(), title, price, desc, img, seller: state.username};
  state.market.push(it);
  state.activities.push({title:`íŒë§¤ ë“±ë¡: ${title} (${price}P)`, time:new Date().toLocaleString()});
  $('#sellTitle').value=''; $('#sellPrice').value=''; $('#sellDesc').value=''; $('#sellImg').value='';
  saveAndRerender();
};

/* ë§ˆì¼“: êµ¬ë§¤ (í¬ì¸íŠ¸ ê¸°ë°˜) */
function buyItem(id){
  const item = state.market.find(i=>i.id==id);
  if(!item) return alert('ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  if(item.seller === state.username) return alert('ìê¸° ìƒí’ˆì€ êµ¬ë§¤í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  if(state.points < item.price) return alert('í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
  // ê±°ë˜ ìˆ˜ìˆ˜ë£Œ 5%
  const fee = Math.ceil(item.price * 0.05);
  state.points -= item.price;
  state.trades += 1;
  // ìˆ˜ìˆ˜ë£ŒëŠ” í”Œë«í¼ì´ ê°€ì ¸ê°, íŒë§¤ì í¬ì¸íŠ¸ëŠ” item.price - fee
  // íŒë§¤ì í¬ì¸íŠ¸ ì²˜ë¦¬ (ê°„ë‹¨ ì‹œë®¬ë ˆì´ì…˜: ë§Œì•½ íŒë§¤ìê°€ ë¡œì»¬ ìœ ì €ë©´ í¬ì¸íŠ¸ ì¶”ê°€)
  if(item.seller === state.username) {
    // unreachable due to earlier check
  } else if(item.seller === state.username) {
    // no-op
  } else {
    // ë§Œì•½ íŒë§¤ìê°€ ë¡œì»¬ ìœ ì €ë¼ë©´ ì²˜ë¦¬ â€” ì´ ë°ëª¨ëŠ” ìƒ˜í”Œ ì‚¬ìš©ìë§Œ ì¡´ì¬í•˜ë¯€ë¡œ ìƒëµ
  }
  // í™œë™ ë¡œê·¸
  state.activities.push({title:`êµ¬ë§¤: ${item.title} (-${item.price}P)`, time:new Date().toLocaleString()});
  // remove item from market
  state.market = state.market.filter(i=>i.id!==id);
  saveAndRerender();
  alert(`êµ¬ë§¤ ì™„ë£Œ! ${item.price}P ì‚¬ìš©, ìˆ˜ìˆ˜ë£Œ ${fee}P`);
}

/* ì¶”ì²œ ì¿ í° êµí™˜ */
$('#redeemBtn').onclick = ()=>{
  const val = parseInt($('#couponSelect').value);
  if(!val) return alert('ì¿ í°ì„ ì„ íƒí•˜ì„¸ìš”.');
  if(state.points < val) return alert('í¬ì¸íŠ¸ ë¶€ì¡±');
  state.points -= val;
  state.activities.push({title:`ì¿ í° êµí™˜ (-${val}P)`, time:new Date().toLocaleString()});
  saveAndRerender();
  alert('ì¿ í°ìœ¼ë¡œ êµí™˜ë˜ì—ˆìŠµë‹ˆë‹¤. ì œíœ´ì‚¬ì—ì„œ ì‚¬ìš©í•˜ì„¸ìš”.');
};

/* Carbon ê³„ì‚° (ë§¤ìš° ë‹¨ìˆœí™”ëœ ê³„ì‚°ì‹, êµìœ¡ìš© ì˜ˆì‹œ) */
$('#calcCarbon').onclick = ()=>{
  const km = parseFloat($('#inputKm').value) || 0; // í•˜ë£¨ ì™•ë³µ km
  const kwh = parseFloat($('#inputKwh').value) || 0; // ì›”
  const veg = parseFloat($('#inputVegDays').value) || 0;
  const house = parseInt($('#inputHouse').value) || 1;

  // êµí†µ: km * 0.21 kgCO2/km (í‰ê·  ìŠ¹ìš©ì°¨) * 365 / 365 -> í•˜ë£¨ê°’ -> ì—°ê°„ ë³€í™˜
  const transportAnnual = (km * 0.21) * 365;
  // ì „ê¸°: kWh * 0.45 kgCO2/kWh (ì§€ì—­ì— ë”°ë¼ ë‹¤ë¦„) -> ì›” -> ì—°
  const energyAnnual = (kwh * 0.45) * 12;
  // ì‹ë‹¨: ì±„ì‹ì¼ìˆ˜ * -0.5kgCO2 * 52 (ì±„ì‹ìœ¼ë¡œ ì ˆê°ë˜ëŠ” ì–‘ ëŒ€ëµ)
  const dietAnnual = (7 - veg) * 0.2 * 52; // ê³ ê¸° ì†Œë¹„ì¼ìˆ˜ì— ë¹„ë¡€ ì¦ê°€ (êµ´ì ˆí™”)
  // ê°€êµ¬ì›ìˆ˜ë¡œ ë‚˜ëˆ”
  let annualCO2 = (transportAnnual + energyAnnual + dietAnnual) / house;
  // ì•ˆì „ì¥ì¹˜
  if(annualCO2 < 0) annualCO2 = 0;

  state.carbon.lastEstimateKg = Math.round(annualCO2);
  state.activities.push({title:`íƒ„ì†Œ ê³„ì‚° (ì˜ˆìƒ ì—°ê°„ ${Math.round(annualCO2)} kgCOâ‚‚e)`, time:new Date().toLocaleString()});
  saveAndRerender();
  alert(`ì˜ˆìƒ ì—°ê°„ ë°°ì¶œëŸ‰: ${Math.round(annualCO2)} kgCOâ‚‚e`);
};

/* ì˜¤í”„ì…‹ (í¬ì¸íŠ¸ë¡œ ë‚˜ë¬´ì‹¬ê¸° ë“±) */
$('#offsetBtn').onclick = ()=>{
  const opt = $('#offsetOption').value;
  const optionEl = $('#offsetOption').selectedOptions[0];
  const cost = parseInt(optionEl.getAttribute('data-cost') || 0);
  if(state.points < cost) return alert('í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.');
  let label = optionEl.textContent;
  state.points -= cost;
  const entry = {id:Date.now(), type: label, cost: cost, time: new Date().toLocaleString()};
  state.carbon.offsets.push(entry);
  state.activities.push({title:`ì˜¤í”„ì…‹: ${label} (-${cost}P)`, time:new Date().toLocaleString()});
  saveAndRerender();
  alert('ì˜¤í”„ì…‹ì´ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì‘ì€ í–‰ë™ì´ ì§€êµ¬ì— ë„ì›€ì´ ë©ë‹ˆë‹¤!');
};

/* ì˜¤í”„ì…‹ íˆìŠ¤í† ë¦¬ ë Œë”ëŠ” renderCarbonê°€ ë‹´ë‹¹ */

/* UI ë„¤ë¹„ê²Œì´ì…˜ */
$$('.nav button').forEach(b=>{
  b.onclick = ()=> {
    $$('.nav button').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    const view = b.getAttribute('data-view');
    // ëª¨ë“  ë·° ìˆ¨ê¸°ê¸°
    ['Dashboard','Missions','Market','Recs','Carbon'].forEach(v=>{
      const el = window['view'+v];
    });
    // ê°„ë‹¨: idë¡œ toggle
    ['viewDashboard','viewMissions','viewMarket','viewRecs','viewCarbon'].forEach(id=>{
      const el = $('#'+id);
      if(!el) return;
      el.style.display = (id.toLowerCase().includes(view)) ? '' : 'none';
    });
  };
});

/* ê²€ìƒ‰ ê°„ë‹¨ ê¸°ëŠ¥ */
$('#search').addEventListener('input', (e)=>{
  const q = e.target.value.trim().toLowerCase();
  if(!q) { renderAll(); return; }
  const mlist = state.missions.filter(m=>m.text.toLowerCase().includes(q));
  const recs = state.recs.filter(r=>r.title.toLowerCase().includes(q) || r.desc.toLowerCase().includes(q));
  const items = state.market.filter(i=>i.title.toLowerCase().includes(q) || i.desc.toLowerCase().includes(q));
  // ê°„ë‹¨íˆ ë³´ì—¬ì£¼ê¸° â€” ë°”ê¿”ì¹˜ê¸°: Missions ë·°ë¡œ ì´ë™í•˜ì—¬ í•„í„° ì ìš©
  $('.nav button[data-view="missions"]').click();
  $('#missionsList').innerHTML = '';
  mlist.forEach(m=>{
    const el = document.createElement('div'); el.className='mission';
    el.innerHTML = `<div class="left"><div class="badge">${m.points}P</div><div><div style="font-weight:800">${m.text}</div></div></div><div><button class="btn green" data-id="${m.id}">ì™„ë£Œ</button></div>`;
    $('#missionsList').appendChild(el);
  });
});

/* í¬ì¸íŠ¸ ë³€ë™ìœ¼ë¡œ ë ˆë²¨ ì—…ë°ì´íŠ¸ (ê°„ë‹¨ ë£°) */
function updateLevel(){
  const p = state.points;
  if(p >= 500) state.level = 5;
  else if(p >= 300) state.level = 4;
  else if(p >= 180) state.level = 3;
  else if(p >= 80) state.level = 2;
  else state.level = 1;
}

/* í˜ì´ì§€ ì´ë²¤íŠ¸ ë°”ì¸ë”© (êµ¬ë§¤ ë²„íŠ¼ ë“± ë™ì  ë°”ì¸ë”©ì€ renderMarketì—ì„œ ì²˜ë¦¬) */
document.addEventListener('click', (e)=>{
  const t = e.target;
  if(t.matches('.mission button')) {
    const id = t.getAttribute('data-id');
    if(t.classList.contains('secondary')) claimReward(id);
    else completeMission(id);
  }
});

/* ì´ˆê¸° ë Œë” */
updateLevel();
renderAll();

/* ìƒíƒœ ìë™ ì €ì¥ ì£¼ê¸° (ì˜ˆ: 10ì´ˆ) â€” ë°ëª¨ìš©ìœ¼ë¡œ ì£¼ì„ ì²˜ë¦¬ ê°€ëŠ¥ */
// setInterval(()=>{ saveStore(state); console.log('ì €ì¥ë¨'); }, 10000);

/* ìµœì´ˆ ì•ˆë‚´ ë¡œê·¸ */
console.log('EcoMission ë°ëª¨ ì‹¤í–‰ â€” ëª¨ë“  ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì € localStorageì— ì €ì¥ë©ë‹ˆë‹¤.');
</script>
</body>
</html>
<!-- ====== ë°±ì—”ë“œ ìŠ¤í… ì½”ë“œ (server.js) ====== -->
<script type="module">
  import express from "https://cdn.skypack.dev/express";

  const app = express();
  app.use(express.json());

  // âœ… ì±Œë¦°ì§€ ì™„ë£Œ API
  app.post("/api/challenge/complete", (req, res) => {
    console.log("âœ… ì±Œë¦°ì§€ ì™„ë£Œ ìš”ì²­ ìˆ˜ì‹ ");
    res.json({ success: true, points: 10 });
  });

  // â™»ï¸ ì¬í™œìš© ì•„ì´í…œ ë“±ë¡ API
  app.post("/api/recycle/add", (req, res) => {
    console.log("â™»ï¸ ì¬í™œìš© ì•„ì´í…œ ë“±ë¡:", req.body.name);
    res.json({ success: true });
  });

  // ğŸŒ íƒ„ì†Œ ê³„ì‚° API
  app.post("/api/carbon", (req, res) => {
    console.log("ğŸŒ íƒ„ì†Œ ê³„ì‚° ìš”ì²­:", req.body);
    res.json({ success: true });
  });

  // ì„œë²„ ì‹¤í–‰
  app.listen(3000, () =>
    console.log("âœ… GreenVerse ì„œë²„ ì‹¤í–‰ ì¤‘: http://localhost:3000")
  );
</script>
